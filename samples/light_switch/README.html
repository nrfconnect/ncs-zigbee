<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Zigbee: Light switch &mdash; Zigbee add-on for nRF Connect SDK 1.0.0 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/nordic.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/togglebutton.css" type="text/css" />
  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../../_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/js/theme.js"></script>
  <script type="text/javascript" src="../../_static/js/ncs.js"></script>

    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Zigbee: NCP" href="../ncp/README.html" />
    <link rel="prev" title="Zigbee: Light bulb" href="../light_bulb/README.html" />
  <link rel="shortcut icon" href="../../_static/images/favicon.ico"/>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Zigbee add-on for nRF Connect SDK
          </a>
<div id="searchbox" role="search">
  <div class="searchformwrapper">
    <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
  </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About Zigbee protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../setup.html">Requirements and setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quick-start.html">Quick start guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../architectures.html">Architectures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../commissioning.html">Commissioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../memory.html">Memory requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configuring.html">Configuring Zigbee add-on</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configuring/index.html">Additional configurations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../zboss/index.html">ZBOSS Zigbee stack</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Samples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../light_bulb/README.html">Zigbee: Light bulb</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Zigbee: Light switch</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#requirements">Requirements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#multiprotocol-bluetooth-le-extension-requirements">Multiprotocol Bluetooth LE extension requirements</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#overview">Overview</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sleepy-end-device-behavior">Sleepy End Device behavior</a></li>
<li class="toctree-l4"><a class="reference internal" href="#multiprotocol-bluetooth-le-extension">Multiprotocol Bluetooth LE extension</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#configuration">Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#source-file-setup">Source file setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configuration-files-for-sample-extensions">Configuration files for sample extensions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configurable-transmission-power">Configurable transmission power</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#user-interface">User interface</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sleepy-end-device-behavior-assignments">Sleepy End Device behavior assignments</a></li>
<li class="toctree-l4"><a class="reference internal" href="#multiprotocol-bluetooth-le-extension-assignments">Multiprotocol Bluetooth LE extension assignments</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#building-and-running">Building and running</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#testing">Testing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#dependencies">Dependencies</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../ncp/README.html">Zigbee: NCP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../network_coordinator/README.html">Zigbee: Network coordinator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/README.html">Zigbee: Shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../template/README.html">Zigbee: Template</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lib/index.html">Libraries for Zigbee</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools.html">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release-notes.html">Release notes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Zigbee add-on for nRF Connect SDK</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Samples</a></li>
      <li class="breadcrumb-item active">Zigbee: Light switch</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/samples/light_switch/README.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="zigbee-light-switch">
<span id="zigbee-light-switch-sample"></span><h1>Zigbee: Light switch<a class="headerlink" href="#zigbee-light-switch" title="Permalink to this heading">ÔÉÅ</a></h1>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#requirements" id="id5">Requirements</a></p>
<ul>
<li><p><a class="reference internal" href="#multiprotocol-bluetooth-le-extension-requirements" id="id6">Multiprotocol Bluetooth LE extension requirements</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#overview" id="id7">Overview</a></p>
<ul>
<li><p><a class="reference internal" href="#sleepy-end-device-behavior" id="id8">Sleepy End Device behavior</a></p></li>
<li><p><a class="reference internal" href="#multiprotocol-bluetooth-le-extension" id="id9">Multiprotocol Bluetooth LE extension</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#configuration" id="id10">Configuration</a></p>
<ul>
<li><p><a class="reference internal" href="#source-file-setup" id="id11">Source file setup</a></p></li>
<li><p><a class="reference internal" href="#configuration-files-for-sample-extensions" id="id12">Configuration files for sample extensions</a></p></li>
<li><p><a class="reference internal" href="#configurable-transmission-power" id="id13">Configurable transmission power</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#user-interface" id="id14">User interface</a></p>
<ul>
<li><p><a class="reference internal" href="#sleepy-end-device-behavior-assignments" id="id15">Sleepy End Device behavior assignments</a></p></li>
<li><p><a class="reference internal" href="#multiprotocol-bluetooth-le-extension-assignments" id="id16">Multiprotocol Bluetooth LE extension assignments</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#building-and-running" id="id17">Building and running</a></p>
<ul>
<li><p><a class="reference internal" href="#testing" id="id18">Testing</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#dependencies" id="id19">Dependencies</a></p></li>
</ul>
</nav>
<p>You can use the this Light switch sample to change the state of light sources on other devices within the same Zigbee network.</p>
<p>You can use it together with the <a class="reference internal" href="../network_coordinator/README.html#zigbee-network-coordinator-sample"><span class="std std-ref">Zigbee Network coordinator</span></a> and the <a class="reference internal" href="../light_bulb/README.html#zigbee-light-bulb-sample"><span class="std std-ref">Zigbee Light bulb</span></a> samples to set up a basic Zigbee network.</p>
<p>This sample supports the optional <a class="reference internal" href="#sleepy-end-device-behavior">Sleepy End Device behavior</a> and <a class="reference internal" href="#zigbee-light-switch-sample-nus"><span class="std std-ref">Multiprotocol Bluetooth LE extension</span></a>.
See <a class="reference internal" href="#zigbee-light-switch-activating-variants"><span class="std std-ref">Configuration files for sample extensions</span></a> for details about how to enable these variants.</p>
<section id="requirements">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Requirements</a><a class="headerlink" href="#requirements" title="Permalink to this heading">ÔÉÅ</a></h2>
<p>The sample supports the following development kits:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Hardware platforms</p></th>
<th class="head"><p>PCA</p></th>
<th class="head"><p>Board name</p></th>
<th class="head"><p>Board target</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference external" href="https://docs.nordicsemi.com/bundle/ncs-latest/page/nrf/app_dev/device_guides/nrf54l/index.html">nRF54L15 DK</a></p></td>
<td><p>PCA10156</p></td>
<td><p><a class="reference external" href="https://docs.nordicsemi.com/bundle/ncs-latest/page/zephyr/boards/nordic/nrf54l15dk/doc/index.html">nrf54l15dk</a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">nrf54l15dk/nrf54l15/cpuapp</span></code></p></td>
</tr>
</tbody>
</table>
<p>To test this sample, you also need to program the following samples:</p>
<ul class="simple">
<li><p>The <a class="reference internal" href="../network_coordinator/README.html#zigbee-network-coordinator-sample"><span class="std std-ref">Zigbee Network coordinator</span></a> sample on one separate device.</p></li>
<li><p>The <a class="reference internal" href="../light_bulb/README.html#zigbee-light-bulb-sample"><span class="std std-ref">Zigbee: Light bulb</span></a> sample on one or more separate devices.</p></li>
</ul>
<section id="multiprotocol-bluetooth-le-extension-requirements">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Multiprotocol Bluetooth LE extension requirements</a><a class="headerlink" href="#multiprotocol-bluetooth-le-extension-requirements" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>If you enable the <a class="reference internal" href="#zigbee-light-switch-sample-nus"><span class="std std-ref">Multiprotocol Bluetooth LE extension</span></a>, make sure you have a phone or a tablet with the <a class="reference external" href="https://www.nordicsemi.com/Software-and-Tools/Development-Tools/nRF-Toolbox">nRF Toolbox</a> application installed.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <a class="reference internal" href="#testing">Testing</a> instructions refer to nRF Toolbox, but you can also use similar applications, for example <a class="reference external" href="https://www.nordicsemi.com/Software-and-Tools/Development-Tools/nRF-Connect-for-mobile">nRF Connect for Mobile</a>.</p>
</div>
</section>
</section>
<section id="overview">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Overview</a><a class="headerlink" href="#overview" title="Permalink to this heading">ÔÉÅ</a></h2>
<p>The Light switch sample demonstrates the Zigbee End Device role and implements the Dimmer Switch device specification, as defined in the Zigbee Home Automation public application profile.</p>
<p>Once the light switch is successfully commissioned, it sends a broadcast message to find devices with the implemented Level Control and On/Off clusters.
The light switch remembers the device network address from the first response.
At this point, you can start using the buttons on the development kit to control the clusters on the newly found devices.</p>
<p>Additionally, the light switch sample powers down unused RAM sections to lower power consumption in the sleep state.</p>
<section id="sleepy-end-device-behavior">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">Sleepy End Device behavior</a><a class="headerlink" href="#sleepy-end-device-behavior" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>The light switch supports the <a class="reference internal" href="../../configuring.html#zigbee-ug-sed"><span class="std std-ref">Sleepy End Device behavior</span></a> that enables the sleepy behavior for the end device, for a significant conservation of energy.</p>
<p>To enable the sleepy behavior, press <strong>Button 2</strong> while the light switch sample is booting.
This is required only when device is joining the network for the first time.
After restarting the device, it will boot with the sleepy behavior enabled.</p>
</section>
<section id="multiprotocol-bluetooth-le-extension">
<span id="zigbee-light-switch-sample-nus"></span><h3><a class="toc-backref" href="#id9" role="doc-backlink">Multiprotocol Bluetooth LE extension</a><a class="headerlink" href="#multiprotocol-bluetooth-le-extension" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>This optional extension demonstrates dynamic concurrent switching between two protocols, Bluetooth¬Æ LE and Zigbee.
It uses the <a class="reference external" href="https://docs.nordicsemi.com/bundle/ncs-latest/page/nrf/libraries/bluetooth_services/services/nus.html">Nordic UART Service (NUS)</a> library.</p>
<p>When this extension is enabled, you can use:</p>
<ul class="simple">
<li><p>Buttons on the light switch device to operate on the Zigbee network</p></li>
<li><p>Nordic UART Service to operate on the Bluetooth LE network</p></li>
</ul>
<p>Both networks are independent from each other.</p>
<p>To support both protocols at the same time, the Zigbee stack uses the <a class="reference external" href="https://docs.nordicsemi.com/bundle/ncs-latest/page/zephyr/connectivity/networking/api/ieee802154.html">IEEE 802.15.4</a> radio during the inactive time of the Bluetooth LE radio (using the Timeslot API of the <a class="reference external" href="https://docs.nordicsemi.com/bundle/ncs-latest/page/nrfxlib/mpsl/README.html">Multiprotocol Service Layer</a>).
Depending on the Bluetooth LE connection interval, the nRF52 development kits can spend up to 99% of the radio time on the Zigbee protocol.</p>
<p>Transmitting and receiving data when using this example does not break connection from any of the used radio protocols, either Bluetooth LE or Zigbee.</p>
<p>For more information about the multiprotocol feature, see <a class="reference external" href="https://docs.nordicsemi.com/bundle/ncs-latest/page/nrf/protocols/multiprotocol/index.html">Multiprotocol support</a> in the nRF Connect SDK documentation.</p>
</section>
</section>
<section id="configuration">
<span id="zigbee-light-switch-configuration"></span><h2><a class="toc-backref" href="#id10" role="doc-backlink">Configuration</a><a class="headerlink" href="#configuration" title="Permalink to this heading">ÔÉÅ</a></h2>
<p>See <a class="reference external" href="https://docs.nordicsemi.com/bundle/ncs-latest/page/nrf/app_dev/config_and_build/index.html">Configuring and building</a> in the nRF Connect SDK documentation for information about how to permanently or temporarily change the configuration.</p>
<section id="source-file-setup">
<h3><a class="toc-backref" href="#id11" role="doc-backlink">Source file setup</a><a class="headerlink" href="#source-file-setup" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>This sample is split into the following source files:</p>
<ul class="simple">
<li><p>The <code class="file docutils literal notranslate"><span class="pre">main</span></code> file to handle initialization and light switch basic behavior.</p></li>
<li><p>An additional <code class="file docutils literal notranslate"><span class="pre">nus_cmd</span></code> file for handling NUS commands.</p></li>
</ul>
</section>
<section id="configuration-files-for-sample-extensions">
<span id="zigbee-light-switch-activating-variants"></span><h3><a class="toc-backref" href="#id12" role="doc-backlink">Configuration files for sample extensions</a><a class="headerlink" href="#configuration-files-for-sample-extensions" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>The sample provides predefined configuration files for optional extensions.
You can find the configuration files in the <code class="file docutils literal notranslate"><span class="pre">samples/zigbee/light_switch</span></code> directory.</p>
<section id="activating-optional-extensions">
<h4>Activating optional extensions<a class="headerlink" href="#activating-optional-extensions" title="Permalink to this heading">ÔÉÅ</a></h4>
<p>To activate the Multiprotocol Bluetooth LE extension, set <strong class="makevar">EXTRA_CONF_FILE</strong> to the <code class="file docutils literal notranslate"><span class="pre">overlay-multiprotocol_ble.conf</span></code>.
For example, when building from the command line, use the following command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">west build samples/zigbee/light_switch -b nrf54l15dk/nrfnrf54l15/cpuapp -- -DEXTRA_CONF_FILE=&#39;overlay-multiprotocol_ble.conf&#39;</span>
</pre></div>
</div>
<p>See <a class="reference external" href="https://docs.nordicsemi.com/bundle/ncs-latest/page/nrf/app_dev/config_and_build/cmake/index.html#providing_cmake_options">Providing CMake options</a> in the nRF Connect SDK documentation for instructions on how to add flags to your build.
For more information about configuration files in the nRF Connect SDK, see <a class="reference external" href="https://docs.nordicsemi.com/bundle/ncs-latest/page/nrf/app_dev/config_and_build/config_and_build_system.html">Build and configuration system</a> in the nRF Connect SDK documentation.</p>
</section>
</section>
<section id="configurable-transmission-power">
<h3><a class="toc-backref" href="#id13" role="doc-backlink">Configurable transmission power</a><a class="headerlink" href="#configurable-transmission-power" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>To achieve a lower power consumption of the light switch, you can configure the transmission power using the <code class="docutils literal notranslate"><span class="pre">CONFIG_LIGHT_SWITCH_CONFIGURE_TX_POWER</span></code> Kconfig option.
You can select per-channel transmission power (in dBm) with the <code class="docutils literal notranslate"><span class="pre">CONFIG_LIGHT_SWITCH_TX_POWER</span></code> Kconfig option.
This affects to all frames sent by the device, even in the network scan phase.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">CONFIG_LIGHT_SWITCH_CONFIGURE_TX_POWER</span></code> Kconfig option is enabled by default and this sample‚Äôs transmission power is set to 0 dBm.</p>
</div>
<p>When the <code class="docutils literal notranslate"><span class="pre">CONFIG_ZIGBEE_CHANNEL_SELECTION_MODE_MULTI</span></code> Kconfig option is set to <code class="docutils literal notranslate"><span class="pre">y</span></code>, the <code class="docutils literal notranslate"><span class="pre">CONFIG_ZIGBEE_APP_CB_QUEUE_LENGTH</span></code> Kconfig option must be increased depending on the channel mask.
For example, in case 16 channels are active, a proper value for <code class="docutils literal notranslate"><span class="pre">CONFIG_ZIGBEE_APP_CB_QUEUE_LENGTH</span></code> would be <code class="docutils literal notranslate"><span class="pre">17</span></code>.
Similar consideration applies to the <code class="docutils literal notranslate"><span class="pre">ZB_CONFIG_IOBUF_POOL_SIZE</span></code> and <code class="docutils literal notranslate"><span class="pre">ZB_CONFIG_SCHEDULER_Q_SIZE</span></code> values configured in the <code class="file docutils literal notranslate"><span class="pre">include/zb_mem_config_custom.h</span></code> file.</p>
</section>
</section>
<section id="user-interface">
<span id="zigbee-light-switch-user-interface"></span><h2><a class="toc-backref" href="#id14" role="doc-backlink">User interface</a><a class="headerlink" href="#user-interface" title="Permalink to this heading">ÔÉÅ</a></h2>
<dl>
<dt>LED 2:</dt><dd><p>Lit and solid when the device is connected to a Zigbee network.</p>
</dd>
<dt>LED 3:</dt><dd><p>Lit and solid when the light switch has found a light bulb to control.</p>
</dd>
<dt>Button 0:</dt><dd><p>Turn on the light bulb connected to the network (light bulb‚Äôs <strong>LED 1</strong>).
This option is available after the successful commissioning (light switch‚Äôs <strong>LED 2</strong> turned on).</p>
<p>Pressing this button for a longer period of time increases the brightness of the <strong>LED 1</strong> of the connected light bulb.</p>
</dd>
<dt>Button 1:</dt><dd><p>Turn off the light bulb connected to the network (light bulb‚Äôs <strong>LED 1</strong>).
This option is available after the successful commissioning (light switch‚Äôs <strong>LED 2</strong> turned on).</p>
<p>Pressing this button for a longer period of time decreases the brightness of the <strong>LED 1</strong> of the connected light bulb.</p>
</dd>
<dt>Button 3:</dt><dd><p>When pressed for five seconds, it initiates the <a class="reference external" href="https://nrfconnect.github.io/ncs-zigbee/zboss/4.1.4.2/using_zigbee__z_c_l.html#reset_factory_defaults">factory reset of the device</a>.
The length of the button press can be edited using the <code class="docutils literal notranslate"><span class="pre">CONFIG_FACTORY_RESET_PRESS_TIME_SECONDS</span></code> Kconfig option from <a class="reference internal" href="../../lib/zigbee_app_utils.html#lib-zigbee-application-utilities"><span class="std std-ref">Zigbee application utilities</span></a>.
Releasing the button within this time does not trigger the factory reset procedure.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the brightness level is at the minimum level, you may not notice the effect of turning on the light bulb.</p>
</div>
<section id="sleepy-end-device-behavior-assignments">
<h3><a class="toc-backref" href="#id15" role="doc-backlink">Sleepy End Device behavior assignments</a><a class="headerlink" href="#sleepy-end-device-behavior-assignments" title="Permalink to this heading">ÔÉÅ</a></h3>
<dl class="simple">
<dt>Button 2:</dt><dd><p>When pressed while resetting the kit, enables the <a class="reference internal" href="../../configuring.html#zigbee-ug-sed"><span class="std std-ref">Sleepy End Device behavior</span></a>.</p>
</dd>
</dl>
</section>
<section id="multiprotocol-bluetooth-le-extension-assignments">
<h3><a class="toc-backref" href="#id16" role="doc-backlink">Multiprotocol Bluetooth LE extension assignments</a><a class="headerlink" href="#multiprotocol-bluetooth-le-extension-assignments" title="Permalink to this heading">ÔÉÅ</a></h3>
<dl>
<dt>LED 0:</dt><dd><p>Lit and solid when a Bluetooth LE Central is connected to the NUS service.
Available when using <a class="reference external" href="https://docs.nordicsemi.com/bundle/ncs-latest/page/nrf/libraries/bluetooth_services/services/nus.html">Nordic UART Service (NUS)</a> in the multiprotocol configuration.</p>
</dd>
<dt>UART command assignments:</dt><dd><p>The following command assignments are configured and used in nRF Toolbox when <a class="reference internal" href="#zigbee-light-switch-testing-ble"><span class="std std-ref">Testing multiprotocol Bluetooth LE extension</span></a>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> - Turn on the Zigbee Light bulb.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code> - Turn off the Zigbee Light bulb.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">t</span></code> - Toggle the Zigbee Light bulb on or off.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">i</span></code> - Increase the brightness level of the Zigbee Light bulb.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">d</span></code> - Decrease the brightness level of the Zigbee Light bulb.</p></li>
</ul>
<p>If more than one light bulb is available in the network, these commands apply to all light bulbs in the network.
See <a class="reference internal" href="#zigbee-light-switch-testing-ble"><span class="std std-ref">Testing multiprotocol Bluetooth LE extension</span></a> for details.</p>
</dd>
</dl>
</section>
</section>
<section id="building-and-running">
<h2><a class="toc-backref" href="#id17" role="doc-backlink">Building and running</a><a class="headerlink" href="#building-and-running" title="Permalink to this heading">ÔÉÅ</a></h2>
<p>Make sure to configure the Zigbee stack before building and testing this sample.
See <a class="reference internal" href="../../configuring.html#ug-zigbee-configuring"><span class="std std-ref">Configuring Zigbee add-on</span></a> for more information.</p>
<p>This sample can be found under <code class="file docutils literal notranslate"><span class="pre">samples/light_switch</span></code> in the Zigbee add-on folder structure.</p>
<p>To build the sample, follow the instructions in <a class="reference external" href="https://docs.nordicsemi.com/bundle/ncs-latest/page/nrf/app_dev/config_and_build/building.html">Building an application</a> in the nRF Connect SDK documentation for your preferred building environment.
See also <a class="reference external" href="https://docs.nordicsemi.com/bundle/ncs-latest/page/nrf/app_dev/programming.html">Programming an application</a> for programming steps and <a class="reference external" href="https://docs.nordicsemi.com/bundle/ncs-latest/page/nrf/test_and_optimize.html">Testing and optimization</a> for general information about testing and debugging in the nRF Connect SDK.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When building <a class="reference external" href="https://docs.nordicsemi.com/bundle/ncs-latest/page/nrf/app_dev/create_application.html#repository_application">repository applications</a> in the Zigbee add-on which is an <a class="reference external" href="https://docs.nordicsemi.com/bundle/ncs-latest/page/nrf/dev_model_and_contributions/code_base.html#repository_types">SDK repository</a>, building with sysbuild is <a class="reference external" href="https://docs.nordicsemi.com/bundle/ncs-latest/page/nrf/app_dev/config_and_build/config_and_build_system.html#sysbuild_enabled_by_default">enabled by default</a>.
If you work with out-of-tree <a class="reference external" href="https://docs.nordicsemi.com/bundle/ncs-latest/page/nrf/app_dev/create_application.html#create-application-types-freestanding">freestanding applications</a>, you need to manually pass the <code class="docutils literal notranslate"><span class="pre">--sysbuild</span></code> parameter to every build command or <a class="reference external" href="https://docs.nordicsemi.com/bundle/ncs-latest/page/nrf/app_dev/config_and_build/sysbuild/sysbuild_configuring_west.html">configure west to always use it</a>.</p>
</div>
<section id="testing">
<span id="zigbee-light-switch-testing"></span><h3><a class="toc-backref" href="#id18" role="doc-backlink">Testing</a><a class="headerlink" href="#testing" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>After programming the sample to your development kits, complete the following steps to test it:</p>
<ol class="arabic">
<li><p>Turn on the development kit that runs the Network coordinator sample.</p>
<p>When <strong>LED 2</strong> turns on, this development kit has become the Coordinator of the Zigbee network.</p>
</li>
<li><p>Turn on the development kit that runs the Light bulb sample.</p>
<p>When <strong>LED 2</strong> turns on, the light bulb has become a Router inside the network.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <strong>LED 2</strong> does not turn on, press <strong>Button 0</strong> on the Coordinator to reopen the network.</p>
</div>
</li>
<li><p>Turn on the development kit that runs the Light switch sample.</p>
<p>When <strong>LED 2</strong> turns on, the light switch has become an End Device, connected directly to the Coordinator.</p>
</li>
<li><p>Wait until <strong>LED 3</strong> on the light switch node turns on.</p>
<p>This LED indicates that the light switch found a light bulb to control.</p>
</li>
</ol>
<p>You can now use buttons on the development kit to control the light bulb, as described in <a class="reference internal" href="#zigbee-light-switch-user-interface"><span class="std std-ref">User interface</span></a>.</p>
<section id="testing-multiprotocol-bluetooth-le-extension">
<span id="zigbee-light-switch-testing-ble"></span><h4>Testing multiprotocol Bluetooth LE extension<a class="headerlink" href="#testing-multiprotocol-bluetooth-le-extension" title="Permalink to this heading">ÔÉÅ</a></h4>
<p>To test the multiprotocol Bluetooth LE extension, you need to complete the standard <a class="reference internal" href="#testing">Testing</a> procedure, set up nRF Toolbox, and then perform the tests using nRF Toolbox.</p>
<p>Set up nRF Toolbox by completing the following steps:</p>
<ol class="arabic">
<li><p>Start UART.</p>
<p>Tap <span class="guilabel">UART</span> to open the UART application in nRF Toolbox.</p>
<figure class="align-default" id="id2">
<img alt="UART application in nRF Toolbox" src="../../_images/nrftoolbox_dynamic_zigbee_uart_1.png" />
<figcaption>
<p><span class="caption-text">UART application in nRF Toolbox</span><a class="headerlink" href="#id2" title="Permalink to this image">ÔÉÅ</a></p>
</figcaption>
</figure>
</li>
<li><p>Configure commands.</p>
<p>Configure the UART commands by completing the following steps:</p>
<ol class="loweralpha">
<li><p>Tap <span class="guilabel">EDIT</span> in the top right corner of the application.
The button configuration window appears.</p></li>
<li><p>Create the active application buttons by completing the following steps:</p>
<ol class="lowerroman simple">
<li><p>Bind the <code class="docutils literal notranslate"><span class="pre">n</span></code> command to one of the buttons, with EOL set to LF and an icon of your choice.</p></li>
<li><p>Bind the <code class="docutils literal notranslate"><span class="pre">f</span></code> command to one of the buttons, with EOL set to LF and an icon of your choice.</p></li>
<li><p>Bind the <code class="docutils literal notranslate"><span class="pre">t</span></code> command to one of the buttons, with EOL set to LF and an icon of your choice.</p></li>
<li><p>Bind the <code class="docutils literal notranslate"><span class="pre">d</span></code> command to one of the buttons, with EOL set to LF and an icon of your choice.</p></li>
<li><p>Bind the <code class="docutils literal notranslate"><span class="pre">i</span></code> command to one of the buttons, with EOL set to LF and an icon of your choice.</p></li>
</ol>
<figure class="align-default" id="id3">
<img alt="Configuring buttons in nRF Toolbox - UART application" src="../../_images/nrftoolbox_dynamic_zigbee_uart_2.png" />
<figcaption>
<p><span class="caption-text">Configuring buttons in the UART application of nRF Toolbox</span><a class="headerlink" href="#id3" title="Permalink to this image">ÔÉÅ</a></p>
</figcaption>
</figure>
</li>
<li><p>Tap <span class="guilabel">DONE</span> in the top right corner of the application.</p></li>
</ol>
</li>
<li><p>Connect to the device.</p>
<p>Tap <span class="guilabel">CONNECT</span> and select the <strong>Zigbee_Switch</strong> device from the list of devices.</p>
<figure class="align-default" id="id4">
<img alt="nRF Toolbox - UART application view after establishing connection" src="../../_images/nrftoolbox_dynamic_zigbee_uart_3.png" />
<figcaption>
<p><span class="caption-text">The UART application of nRF Toolbox after establishing the connection</span><a class="headerlink" href="#id4" title="Permalink to this image">ÔÉÅ</a></p>
</figcaption>
</figure>
<p>Observe that <strong>LED 0</strong> on the light switch node is solid.
This indicates that the Bluetooth LE connection is established.</p>
</li>
</ol>
<p>In nRF Toolbox, tap the buttons you assigned to perform the test:</p>
<ol class="arabic simple">
<li><p>Tap the <span class="guilabel">n</span> and <span class="guilabel">f</span> command buttons to turn the LED on the Zigbee Light bulb node on and off, respectively.</p></li>
<li><p>Tap the <span class="guilabel">t</span> command button two times to toggle the LED on the Zigbee Light bulb node on and off.</p></li>
<li><p>Tap the <span class="guilabel">i</span> and <span class="guilabel">d</span> command buttons to make adjustments to the brightness level.</p></li>
</ol>
<p>You can now control the devices either with the buttons on the development kits or with the NUS UART command buttons in the nRF Toolbox application.</p>
</section>
<section id="sample-output">
<h4>Sample output<a class="headerlink" href="#sample-output" title="Permalink to this heading">ÔÉÅ</a></h4>
<p>You can observe the sample logging output through a serial port after connecting with a terminal emulator (for example, nRF Connect Serial Terminal).
See <a class="reference external" href="https://docs.nordicsemi.com/bundle/ncs-latest/page/nrf/test_and_optimize.html">Testing and optimization</a> in the nRF Connect SDK documentation for the required settings and steps.</p>
</section>
</section>
</section>
<section id="dependencies">
<h2><a class="toc-backref" href="#id19" role="doc-backlink">Dependencies</a><a class="headerlink" href="#dependencies" title="Permalink to this heading">ÔÉÅ</a></h2>
<p>This sample uses the following nRF Connect SDK libraries:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.nordicsemi.com/bundle/ncs-latest/page/nrf/libraries/others/ram_pwrdn.html">RAM power-down</a></p></li>
<li><p><a class="reference internal" href="../../lib/zigbee_error_handler.html#lib-zigbee-error-handler"><span class="std std-ref">Zigbee error handler</span></a></p></li>
<li><p><a class="reference internal" href="../../lib/zigbee_app_utils.html#lib-zigbee-application-utilities"><span class="std std-ref">Zigbee application utilities</span></a></p></li>
<li><p>Zigbee subsystem:</p>
<ul>
<li><p><code class="file docutils literal notranslate"><span class="pre">zb_nrf_platform.h</span></code></p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://docs.nordicsemi.com/bundle/ncs-latest/page/nrf/libraries/others/dk_buttons_and_leds.html">DK Buttons and LEDs</a></p></li>
</ul>
<p>It uses the ZBOSS stack:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../zboss/index.html#zigbee-zboss"><span class="std std-ref">ZBOSS Zigbee stack</span></a> 4.1.4.2 (<a class="reference external" href="https://nrfconnect.github.io/ncs-zigbee/zboss/4.1.4.2/zigbee_devguide.html">API documentation</a>)</p></li>
</ul>
<p>In addition, it uses the following Zephyr libraries:</p>
<ul class="simple">
<li><p><code class="file docutils literal notranslate"><span class="pre">include/zephyr.h</span></code></p></li>
<li><p><code class="file docutils literal notranslate"><span class="pre">include/device.h</span></code></p></li>
<li><p><a class="reference external" href="https://docs.nordicsemi.com/bundle/ncs-latest/page/zephyr/services/logging/index.html">Logging</a></p></li>
</ul>
<p>The following dependencies are added by the multiprotocol Bluetooth LE extension:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.nordicsemi.com/bundle/ncs-latest/page/nrfxlib/softdevice_controller/README.html">SoftDevice Controller</a></p></li>
<li><p><a class="reference external" href="https://docs.nordicsemi.com/bundle/ncs-latest/page/nrf/libraries/bluetooth_services/services/nus.html">Nordic UART Service (NUS)</a></p></li>
<li><p>Zephyr‚Äôs <a class="reference external" href="https://docs.nordicsemi.com/bundle/ncs-latest/page/zephyr/connectivity/bluetooth/api/index.html">Bluetooth API</a>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">include/bluetooth/bluetooth.h</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">include/bluetooth/gatt.h</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">include/bluetooth/hci.h</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">include/bluetooth/uuid.h</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">include/bluetooth/services/nus.h</span></code></p></li>
</ul>
</li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../ncp/README.html" class="btn btn-neutral float-right" title="Zigbee: NCP" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../light_bulb/README.html" class="btn btn-neutral" title="Zigbee: Light bulb" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">

<table>
<tr>
<td>
    <p>
        &copy; Copyright 2024, Nordic Semiconductor.

    </p>
</td>
<td id="nordiclogo">
  <a href="https://www.nordicsemi.com/"><img src="../../_static/images/nordic.svg" border="0"/></a>
</td>
</tr>
</table>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 


</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>